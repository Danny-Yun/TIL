# 관점지향 프로그래밍(AOP)과 트랙잭션

AOP는 핵심 로직과 보조 로직을 분리하자는 개념에서 출발한다.    
여태까지는 모든 메서드의 실행 소요시간이 몇 초인지 구하고 싶으면 메서드마다 기능을 추가해야 했다.      
이제는 실행 소요시간을 구하는 기능을 하나만 만들어 두면, 모든 메서드에 기능을 전역적으로 추가하거나 기능을 추가할 메서드의 범위를 지정할 수도 있다.

<br>

이런 개념을 AOP라고 부르며, 주로 로그, 보안 등 주요 기능은 아니지만 주요 기능을 보조하는 기능을 구현할 때 많이 사용한다.    
그리고 관점지향 프로그래밍(AOP)은 프로그램 구조에 대해 다른 방향성을 제시하면서 객체지향 프로그램(OOP)을 보완하고 있다.    
OOP에서의 핵심 단위가 **클래스(Class)** 라면, AOP에서의 핵심 단위는 **Aspect(관점,관심)** 이다. 

<br>

쉽게 말하면, **필수적이지만 어쩔 수 없이 반복적으로 사용되는 코드들을 리팩토링할 수 있도록** 도와준다.     
이로인해 여러 곳에서 사용될만한 코드들이 한 곳에서 유지하고 관리할 수 있는 이점을 가지게 된다. 

<br>

이러한 접근방식은 비즈니스 로직을 분리하여 좀더 쉽게 유지보수할 수 있도록 한다.     
다른 기능들을 다른 관점에 두어 분리한다. 관점은 여러 클래스에 흩어져 있는 관심사들의 모듈화라고 볼 수 있다.    
가장 간단한 예를 들면 트랜잭션 처리와 통합로깅 정도가 될 것 같다.

<br>

| 타입 | 기능 |
|:------:|:------------:|
| Before | 주요 메서드 실행 전에 먼저 실행하는 aop |
| AfterReturning | 메서드 정상 호출 후에 return구문이 끝나고 실행하는 aop |
| AfterThrowing | 에러처리를 한 뒤에 실행되는 aop |
| After | 예외여부 상관없이 메서드호출이 끝난 뒤 호출할 때 | 
| Around | 호출 이전부터 호출 이후까지 쭉 실행할 때 |

<br>

| 용어 | 의미 |
|:------:|:------------:|
| Aspect | 관심사. 공통적으로 사용할 기능을 통틀어 부르는 명칭. |
| Advice | Aspect를 적용받은 실제 객체. |
| Join point | Aspect를 적용할 수 있는 후보 객체. |
| Pointcut | Join point 중 실제로 적용할 예정인 객체. | 
| Target | Join point가 가지고 있는 메서드들. |
| Proxy | Advice가 적용된 객체를 생성한 것. |
| Introduction | target에 없는 새로운 메서드, 변수 등을 추가하는 경우 |
| Weaving | Advice를 Target에 적용하는 행위. |

<br><hr><br/>

트랜잭션은 2개 이상의 쿼리문이 실행된다면 전부 실행되고, 실패한다면 전부 실패하게 만드는 것을 의미한다.    
아래의 4가지 원칙에 따라 기능을 묶어주는 것이 트랜잭션이다. 

<br>

| 용어 | 의미 |
|:------:|:------------:|
| 원자성 <br> (Atomicity) | 하나의 트랜잭션은 하나의 단위로 처리되어야 한다.  ex) 게시판의 글과 댓글은 무조건 함께 삭제되거나 함께 삭제되지 않아야 함. |
| 일관성 <br> (Consistency) | 트랜잭션으로 처리된 데이터는 트랜잭션이 아닌 일반로직으로 처리된 데이터와 차이가 없어야 한다. |
| 격리 <br> (Isolation) | 트랜잭션으로 처리되는 도중 외부 간섭을 받아서는 안 된다. |
| 영속성 <br> (Durability) | 트랜잭션이 일단 처리되면, 처리 결과는 돌이킬 수 없어야 한다.  |
